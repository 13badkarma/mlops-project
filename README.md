# Задача

Для скорости и простоты взял **Social Network ads** задачу c
[Kaggle](https://www.kaggle.com/datasets/rakeshrau/social-network-ads).
На которой применил логистическую регрессию.

## Установка и настройка

1. **Склонировать репозиторий** `git clone` используя [ssh](git@github.com:13badkarma/mlops-project.git)
   или [https](https://github.com/13badkarma/mlops-project.git) ссылку

2. **Создать виртуальное окружение внутри скаченного проекта**
   `python -m venv .venv`.

3. **Активировать venv и установить poetry**

   `pip install poetry`

4. **Установите все необходимые зависимости проекта**

   `poetry install`. Убедиться, что установка прошла успешно

5. **Запуск pre-commit** 

    `pre-commit run -a` И убедится, что black, isort, flake8 passed. 

6. **Можно также собрать колесо**

    `poetry build` пакет появится в папке dist


## Проверка перед запуском.
Проверить конфиг `configs/train.yaml`, что правильно указан адрес и порт MLFlow
Указана правильная папка для событий TensorBoard. По дефолту в конфиге указан относительный
путь к папке runs. Относительный к скриптам `train.py и infer.py`


## Обучение модели

1. **Обучение модели** Перейти в папку logistic_regression. Либо запустить по пути

  `python train.py` или  `python ./logistic-regression/train.py`

Скрипт сам выгрузит  данные из DVC, сделает модель на основе train данных. Сохранит данную модель на диск
и сделает ее пуш в DVC

## Использование модели для предсказаний

1. **Проверка модели на test данных** По аналогии с train запустить можно следующими способами.
В зависимости от текущей директории. 

`python infer.py` или  `python ./logistic-regression/infer.py`

Скрипт загружает при необходимости данные из dvc (т.е. может работать и без train) 
Сохраняет результат в csv файл с признаками и предсказанным target в  `../data/predictions.csv`



## Выводы
В рамках выполнения данного задания. Получил представление о том как можно использовать DVC 
для хранения файлов, что бы в git хранить только инфморацию по данным файлам в формате
{filename/dirname}.dvc
C MLFlow уже был небольшой опыт на курсе ML OPS начало . TensorBoard был для меня в новинку.
Понравилось легкость использования библиотеки pre-commit, что не нужно разбираться в синтаксисе git hook
, а достаточно просто настраивается. Единственное столкнулся с конфликтом плагина black и isort 
и после небольшого гугления проблема решилась через конфигурацию isort
args: `["--profile", "black"]`. Познакомился с Hydra и OmegaConf, действительно удобная работа с конфигурациями.
Также как я понял, в Hydra можно делать multirun на разных конфигах. Например сделать набор конфигураций различных train.yaml
в плане конфигурации model и запустить с разными значениями max_iter. tolerance и т.д. 
Единственное столкнулся с проблемой, что не совсем тривиально в Hydro стандартный logger заменить на loguru. 



